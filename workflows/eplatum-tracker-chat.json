{
  "name": "Eplatum Tracker Chat",
  "nodes": [
    {
      "parameters": {
        "updates": [
          "message"
        ]
      },
      "id": "telegram-trigger-node",
      "name": "Telegram Trigger",
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        0,
        0
      ],
      "credentials": {
        "telegramApi": {
          "id": "REPLACE_WITH_TELEGRAM_CREDENTIALS_ID",
          "name": "Telegram Bot"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Extract chat_id, user_id, text and detect commands\nconst item = $input.item.json;\nconst message = item.message || item.edited_message || {};\nconst chat = message.chat || {};\nconst from = message.from || {};\nconst text = message.text || '';\n\nconst chatId = chat.id;\nconst userId = from.id;\nconst userName = from.first_name || 'User';\n\n// Command detection\nconst commands = ['/start', '/status', '/nudge', '/snooze', '/reset', '/help'];\nlet command = null;\nlet commandArg = null;\n\nif (text.startsWith('/')) {\n  const parts = text.trim().split(/\\s+/);\n  command = parts[0].toLowerCase();\n  commandArg = parts.slice(1).join(' ');\n  \n  if (command === '/nudge' && commandArg) {\n    const level = commandArg.toLowerCase();\n    if (['low', 'medium', 'high'].includes(level)) {\n      commandArg = level;\n    } else {\n      commandArg = null;\n    }\n  }\n  \n  if (command === '/snooze' && commandArg) {\n    // Parse 24h, 72h format\n    const match = commandArg.match(/^(\\d+)(h|d)$/i);\n    if (match) {\n      const num = parseInt(match[1]);\n      const unit = match[2].toLowerCase();\n      commandArg = { hours: unit === 'h' ? num : num * 24 };\n    } else {\n      commandArg = null;\n    }\n  }\n}\n\nreturn {\n  chatId,\n  userId,\n  userName,\n  text: command ? command : text,\n  command,\n  commandArg,\n  isCommand: !!command\n};"
      },
      "id": "extract-node",
      "name": "Extract",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        200,
        0
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO users (tg_user_id, tg_chat_id, last_seen)\nVALUES ({{ $json.userId }}, {{ $json.chatId }}, now())\nON CONFLICT (tg_user_id) DO UPDATE\nSET tg_chat_id = EXCLUDED.tg_chat_id,\n    last_seen = now(),\n    updated_at = now()\nRETURNING *;"
      },
      "id": "upsert-user-node",
      "name": "Upsert User",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [
        400,
        0
      ],
      "credentials": {
        "postgres": {
          "id": "REPLACE_WITH_SUPABASE_CREDENTIALS_ID",
          "name": "Supabase"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "condition-command-start",
              "leftValue": "={{ $json.command }}",
              "rightValue": "/start",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "condition-command-status",
              "leftValue": "={{ $json.command }}",
              "rightValue": "/status",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "condition-command-nudge",
              "leftValue": "={{ $json.command }}",
              "rightValue": "/nudge",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "condition-command-snooze",
              "leftValue": "={{ $json.command }}",
              "rightValue": "/snooze",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "condition-command-reset",
              "leftValue": "={{ $json.command }}",
              "rightValue": "/reset",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "condition-command-help",
              "leftValue": "={{ $json.command }}",
              "rightValue": "/help",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "id": "switch-command-node",
      "name": "Switch Command",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.1,
      "position": [
        600,
        0
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT * FROM users WHERE tg_user_id = {{ $json.userId }} LIMIT 1;"
      },
      "id": "get-user-node",
      "name": "Get User",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [
        800,
        0
      ],
      "credentials": {
        "postgres": {
          "id": "REPLACE_WITH_SUPABASE_CREDENTIALS_ID",
          "name": "Supabase"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Process onboarding response or generate next step\nconst user = $input.item.json;\nconst extractData = $('Extract').item.json;\nconst currentStep = user.current_step || 1;\nconst profile = user.profile || {};\nconst text = extractData.text;\n\nconst questions = [\n  null, // Step 0 (no question)\n  '–ß—Ç–æ —Ö–æ—á–µ—à—å –∏–∑–º–µ–Ω–∏—Ç—å? (—Ä–∞–±–æ—Ç–∞/–±–∏–∑–Ω–µ—Å/–∂–∏–∑–Ω—å/–¥–µ–Ω—å–≥–∏/—Å–º—ã—Å–ª)',\n  '–ö–∞–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è? (–≤—Ä–µ–º—è –≤ –Ω–µ–¥–µ–ª—é, –¥–µ–Ω—å–≥–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç, —è–∑—ã–∫, —Å—Ç—Ä–∞–Ω–∞/–≥–æ—Ä–æ–¥)',\n  '–ß—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –Ω—Ä–∞–≤–∏—Ç—Å—è? (3 –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏/—Ç–µ–º—ã)',\n  '–ß—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è? (3 –Ω–∞–≤—ã–∫–∞/–æ–ø—ã—Ç–∞)',\n  '–ö–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç? (–Ω–∞–π–º/—Ñ—Ä–∏–ª–∞–Ω—Å/—Å–≤–æ–π –ø—Ä–æ–¥—É–∫—Ç/–∫–æ–Ω—Ç–µ–Ω—Ç/–∫–æ–Ω—Å–∞–ª—Ç–∏–Ω–≥/–ª–æ–∫–∞–ª—å–Ω—ã–π –±–∏–∑–Ω–µ—Å)',\n  '–†–∏—Å–∫/—Ç–µ–º–ø? (–±–µ–∑–æ–ø–∞—Å–Ω–æ/–±—ã—Å—Ç—Ä–æ/–∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ)',\n  '–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞ –Ω–∞ 30 –¥–Ω–µ–π? (—á—Ç–æ –±—É–¥–µ—Ç \"–ø–æ–±–µ–¥–æ–π\")'\n];\n\nlet newStep = currentStep;\nlet answerKey = `s${currentStep}`;\nlet mirrorText = '–ü—Ä–∏–Ω—è—Ç–æ.';\nlet nextQuestion = null;\nlet nextTask = null;\n\n// Save answer if not a command\nif (!extractData.isCommand && currentStep <= 7) {\n  profile.answers = profile.answers || {};\n  profile.answers[answerKey] = text;\n  newStep = currentStep + 1;\n  \n  // Try LLM for mirror (fallback to simple)\n  try {\n    mirrorText = `–ü–æ–Ω—è–ª: ${text.substring(0, 50)}${text.length > 50 ? '...' : ''}`;\n  } catch (e) {\n    mirrorText = '–ü—Ä–∏–Ω—è—Ç–æ.';\n  }\n}\n\n// Get next question or task\nif (newStep <= 7) {\n  nextQuestion = questions[newStep];\n} else {\n  // Onboarding complete - generate 15min task\n  nextTask = '–ü—Ä–æ–≤–µ—Ä—å 3 —Ä–µ—Å—É—Ä—Å–∞ –≤ —Ç–≤–æ–µ–π –æ–±–ª–∞—Å—Ç–∏ –∑–∞ 15 –º–∏–Ω—É—Ç';\n  \n  // Try LLM for personalized task (fallback)\n  try {\n    const domain = profile.answers?.s5 || '–≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é';\n    nextTask = `–ù–∞–π–¥–∏ 1 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä —É—Å–ø–µ—Ö–∞ –≤ ${domain} ‚Äî –∑–∞–π–º–µ—Ç 15 –º–∏–Ω—É—Ç`;\n  } catch (e) {\n    // Keep default\n  }\n}\n\n// Calculate next reminder time based on nudge_level\nconst nudgeLevel = user.nudge_level || 'medium';\nconst nudgeHours = nudgeLevel === 'low' ? 48 : (nudgeLevel === 'high' ? 8 : 24);\nconst nextNudgeAt = new Date(Date.now() + nudgeHours * 60 * 60 * 1000).toISOString();\n\nreturn {\n  ...user,\n  profile,\n  current_step: newStep,\n  mirrorText,\n  nextQuestion,\n  nextTask,\n  nextNudgeAt\n};"
      },
      "id": "process-onboarding-node",
      "name": "Process Onboarding",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1000,
        0
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE users\nSET current_step = {{ $json.current_step }},\n    profile = '{{ JSON.stringify($json.profile) }}'::jsonb,\n    last_seen = now(),\n    updated_at = now()\nWHERE tg_user_id = {{ $('Extract').item.json.userId }}\nRETURNING *;"
      },
      "id": "update-user-node",
      "name": "Update User",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [
        1200,
        0
      ],
      "credentials": {
        "postgres": {
          "id": "REPLACE_WITH_SUPABASE_CREDENTIALS_ID",
          "name": "Supabase"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO reminders (tg_user_id, kind, next_at)\nVALUES ({{ $('Extract').item.json.userId }}, 'nudge', '{{ $json.nextNudgeAt }}')\nON CONFLICT DO NOTHING;\n\nUPDATE reminders\nSET next_at = '{{ $json.nextNudgeAt }}',\n    updated_at = now()\nWHERE tg_user_id = {{ $('Extract').item.json.userId }} AND kind = 'nudge';"
      },
      "id": "update-reminder-node",
      "name": "Update Reminder",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [
        1400,
        0
      ],
      "credentials": {
        "postgres": {
          "id": "REPLACE_WITH_SUPABASE_CREDENTIALS_ID",
          "name": "Supabase"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Format bot response\nconst processed = $input.item.json;\nconst extractData = $('Extract').item.json;\n\nlet responseText = '';\n\nif (processed.mirrorText) {\n  responseText += `${processed.mirrorText}\\n\\n`;\n}\n\nif (processed.nextQuestion) {\n  responseText += `‚ùì ${processed.nextQuestion}`;\n} else if (processed.nextTask) {\n  responseText += `‚úÖ –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω!\\n\\nüéØ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –Ω–∞ 15 –º–∏–Ω—É—Ç:\\n${processed.nextTask}`;\n  \n  // Create task\n  return {\n    ...processed,\n    responseText,\n    shouldCreateTask: true\n  };\n}\n\nreturn {\n  ...processed,\n  responseText\n};"
      },
      "id": "format-response-node",
      "name": "Format Response",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1600,
        0
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO messages (tg_user_id, role, text)\nVALUES ({{ $('Extract').item.json.userId }}, 'user', '{{ $('Extract').item.json.text }}');\n\nINSERT INTO messages (tg_user_id, role, text)\nVALUES ({{ $('Extract').item.json.userId }}, 'bot', '{{ $json.responseText }}');"
      },
      "id": "save-messages-node",
      "name": "Save Messages",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [
        1800,
        0
      ],
      "credentials": {
        "postgres": {
          "id": "REPLACE_WITH_SUPABASE_CREDENTIALS_ID",
          "name": "Supabase"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Extract').item.json.chatId }}",
        "text": "={{ $json.responseText }}",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "send-telegram-node",
      "name": "Send Telegram",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2000,
        0
      ],
      "credentials": {
        "telegramApi": {
          "id": "REPLACE_WITH_TELEGRAM_CREDENTIALS_ID",
          "name": "Telegram Bot"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Handle /start command\nconst user = $input.item.json;\nconst currentStep = user.current_step || 1;\n\nconst questions = [\n  null,\n  '–ü—Ä–∏–≤–µ—Ç! üëã –≠—Ç–æ Eplatum Tracker ‚Äî —Ç–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –≤ –ø—Ä–æ—Ñ–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–µ.\\n\\n–ù–∞—á–Ω–µ–º —Å –ø–µ—Ä–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞:',\n  null, null, null, null, null, null, null\n];\n\nlet responseText = '';\n\nif (currentStep === 1) {\n  responseText = questions[1] + '\\n\\n‚ùì –ß—Ç–æ —Ö–æ—á–µ—à—å –∏–∑–º–µ–Ω–∏—Ç—å? (—Ä–∞–±–æ—Ç–∞/–±–∏–∑–Ω–µ—Å/–∂–∏–∑–Ω—å/–¥–µ–Ω—å–≥–∏/—Å–º—ã—Å–ª)';\n} else {\n  responseText = `–ü—Ä–æ–¥–æ–ª–∂–∏–º —Å —à–∞–≥–∞ ${currentStep}.\\n\\n–ò—Å–ø–æ–ª—å–∑—É–π /status –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞, /help –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏.`;\n}\n\nreturn {\n  ...user,\n  responseText\n};"
      },
      "id": "handle-start-node",
      "name": "Handle /start",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        800,
        200
      ]
    },
    {
      "parameters": {
        "jsCode": "// Handle /status command\nconst user = $input.item.json;\nconst totalSteps = 7;\nconst progress = Math.round((user.current_step / totalSteps) * 100);\n\nlet responseText = `üìä –¢–≤–æ–π —Å—Ç–∞—Ç—É—Å:\\n\\n`;\nresponseText += `–®–∞–≥: ${user.current_step}/${totalSteps} (${progress}%)\\n`;\nresponseText += `–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è: ${user.nudge_level || 'medium'}\\n`;\n\nif (user.snoozed_until) {\n  responseText += `–ü–∞—É–∑–∞ –¥–æ: ${new Date(user.snoozed_until).toLocaleString('ru-RU')}\\n`;\n}\n\nresponseText += `\\n–ò—Å–ø–æ–ª—å–∑—É–π /help –¥–ª—è –∫–æ–º–∞–Ω–¥.`;\n\nreturn {\n  ...user,\n  responseText\n};"
      },
      "id": "handle-status-node",
      "name": "Handle /status",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        800,
        400
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE users\nSET nudge_level = '{{ $('Extract').item.json.commandArg }}',\n    updated_at = now()\nWHERE tg_user_id = {{ $('Extract').item.json.userId }}\nRETURNING *;"
      },
      "id": "handle-nudge-node",
      "name": "Handle /nudge",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [
        1000,
        600
      ],
      "credentials": {
        "postgres": {
          "id": "REPLACE_WITH_SUPABASE_CREDENTIALS_ID",
          "name": "Supabase"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Handle /snooze command\nconst extractData = $('Extract').item.json;\nconst user = $input.item.json;\n\nlet responseText = '';\n\nif (extractData.commandArg && extractData.commandArg.hours) {\n  const hours = extractData.commandArg.hours;\n  const snoozedUntil = new Date(Date.now() + hours * 60 * 60 * 1000).toISOString();\n  \n  responseText = `–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ ${hours}—á. –ò—Å–ø–æ–ª—å–∑—É–π /start –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è.`;\n  \n  return {\n    ...user,\n    snoozed_until: snoozedUntil,\n    responseText\n  };\n} else {\n  return {\n    ...user,\n    responseText: '–§–æ—Ä–º–∞—Ç: /snooze 24h –∏–ª–∏ /snooze 72h'\n  };\n}"
      },
      "id": "handle-snooze-node",
      "name": "Handle /snooze",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1000,
        800
      ]
    },
    {
      "parameters": {
        "jsCode": "// Handle /reset command\nconst extractData = $('Extract').item.json;\nconst user = $input.item.json;\n\nif (extractData.commandArg === 'RESET') {\n  return {\n    ...user,\n    responseText: '–°–±—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–π /start –¥–ª—è –Ω–∞—á–∞–ª–∞ –∑–∞–Ω–æ–≤–æ.',\n    shouldReset: true\n  };\n} else {\n  return {\n    ...user,\n    responseText: '–î–ª—è —Å–±—Ä–æ—Å–∞ –Ω–∞–ø–∏—à–∏: RESET (–∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏)'\n  };\n}"
      },
      "id": "handle-reset-check-node",
      "name": "Handle /reset Check",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1000,
        1000
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE users\nSET current_step = 1,\n    profile = '{}'::jsonb,\n    updated_at = now()\nWHERE tg_user_id = {{ $('Extract').item.json.userId }};\n\nDELETE FROM tasks WHERE tg_user_id = {{ $('Extract').item.json.userId }};\nDELETE FROM reminders WHERE tg_user_id = {{ $('Extract').item.json.userId }};"
      },
      "id": "handle-reset-exec-node",
      "name": "Handle /reset Exec",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [
        1200,
        1000
      ],
      "credentials": {
        "postgres": {
          "id": "REPLACE_WITH_SUPABASE_CREDENTIALS_ID",
          "name": "Supabase"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Extract').item.json.chatId }}",
        "text": "={{ $json.responseText }}"
      },
      "id": "send-command-response-node",
      "name": "Send Command Response",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        1400,
        400
      ],
      "credentials": {
        "telegramApi": {
          "id": "REPLACE_WITH_TELEGRAM_CREDENTIALS_ID",
          "name": "Telegram Bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Extract').item.json.chatId }}",
        "text": "üìö **Eplatum Tracker ‚Äî –°–ø—Ä–∞–≤–∫–∞**\\n\\n**–ö–æ–º–∞–Ω–¥—ã:**\\n/start ‚Äî –Ω–∞—á–∞—Ç—å/–ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å\\n/status ‚Äî —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å\\n/nudge low|medium|high ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å\\n/snooze 24h|72h ‚Äî –ø–∞—É–∑–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π\\n/reset ‚Äî —Å–±—Ä–æ—Å–∏—Ç—å (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)\\n/help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "id": "handle-help-node",
      "name": "Handle /help",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        1000,
        1200
      ],
      "credentials": {
        "telegramApi": {
          "id": "REPLACE_WITH_TELEGRAM_CREDENTIALS_ID",
          "name": "Telegram Bot"
        }
      }
    }
  ],
  "connections": {
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Extract",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract": {
      "main": [
        [
          {
            "node": "Upsert User",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upsert User": {
      "main": [
        [
          {
            "node": "Switch Command",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch Command": {
      "main": [
        [
          {
            "node": "Handle /start",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Handle /status",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Handle /nudge",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Handle /snooze",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Handle /reset Check",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Handle /help",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Get User",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get User": {
      "main": [
        [
          {
            "node": "Process Onboarding",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Onboarding": {
      "main": [
        [
          {
            "node": "Update User",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update User": {
      "main": [
        [
          {
            "node": "Update Reminder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Reminder": {
      "main": [
        [
          {
            "node": "Format Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Response": {
      "main": [
        [
          {
            "node": "Save Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save Messages": {
      "main": [
        [
          {
            "node": "Send Telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Handle /start": {
      "main": [
        [
          {
            "node": "Send Command Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Handle /status": {
      "main": [
        [
          {
            "node": "Send Command Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Handle /nudge": {
      "main": [
        [
          {
            "node": "Send Command Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Handle /snooze": {
      "main": [
        [
          {
            "node": "Update User",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Handle /reset Check": {
      "main": [
        [
          {
            "node": "Handle /reset Exec",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send Command Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "timezone": "Europe/Warsaw"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2024-01-01T00:00:00.000Z",
  "active": false,
  "versionId": "212f4eee-f0fb-480e-8d33-7535b95bdb8f"
}
